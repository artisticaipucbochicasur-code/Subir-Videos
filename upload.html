<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Subir video a DECOM IPUC BOCHICA SUR</title>
  </head>
  <body>
    <h2>Subir video a DECOM IPUC BOCHICA SUR</h2>
    <input type="file" id="fileInput" accept="video/*" />
    <br><br>
    <button onclick="upload()">Subir video</button>
    <div id="status"></div>

    <script>
      async function upload() {
        const fileInput = document.getElementById('fileInput');
        const file = fileInput.files[0];
        if (!file) {
          alert("Selecciona un video primero.");
          return;
        }

        const identifier = 'video_' + Date.now(); // ID único
        const accessKey = 'eQc2fktg0PEYWqQh'; // <-- reemplaza esto
        const secretKey = 'x4W4nohzqeIkcrPy'; // <-- reemplaza esto

        const url = `https://s3.us.archive.org/${identifier}/${file.name}`;

        const headers = new Headers();
        headers.append('authorization', 'LOW ' + accessKey + ':' + secretKey);

        const response = await fetch(url, {
          method: 'PUT',
          body: file,
          headers: {
            Authorization: `LOW ${accessKey}:${secretKey}`,
            'x-archive-auto-make-bucket': '1',
            'x-archive-meta-title': file.name,
            'x-archive-meta-collection': 'opensource_movies',
            'x-archive-meta-mediatype': 'movies',
            'x-archive-meta-description': 'Subido desde App',
            'Content-Type': file.type
          }
        });

        if (response.ok) {
          document.getElementById("status").innerHTML = `
            <p>✅ Subido correctamente a Archive.org</p>
            <a href="https://archive.org/details/${identifier}" target="_blank">
              Ver video en Archive
            </a>
          `;
        } else {
          const text = await response.text();
          document.getElementById("status").innerHTML = `<p>❌ Error: ${text}</p>`;
        }
      }
    </script>
  </body>
</html>
