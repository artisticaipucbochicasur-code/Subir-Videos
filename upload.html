<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Subir video a DECOM</title>
    <style>
      #copyButton {
        display: none;
        margin-top: 10px;
      }
    </style>
  </head>
  <body>
    <h2>Subir video a DECOM</h2>
    <form id="uploadForm" method="POST" enctype="multipart/form-data" action="https://store10.gofile.io/uploadFile">
      <input type="file" name="file" accept="video/*" required />
      <input type="hidden" name="token" value="icoEBPihfwCSpUwviOv77DUO6GDxAJJa">
      <br><br>
      <input type="submit" value="Subir video" />
    </form>
    <div id="response"></div>
    <button id="copyButton">üìã Copiar link</button>

    <script>
      let lastLink = "";

      document.getElementById("uploadForm").onsubmit = function(event) {
        event.preventDefault();
        var form = document.getElementById("uploadForm");
        var formData = new FormData(form);

        fetch(form.action, {
          method: "POST",
          body: formData
        })
        .then(response => response.json())
        .then(data => {
          if (data.status === "ok") {
            const link = data.data.downloadPage;

            lastLink = link;
            document.getElementById("response").innerHTML = "<p>Subido correctamente:</p><a href='" + link + "' target='_blank'>" + link + "</a>";
            document.getElementById("copyButton").style.display = "inline-block";
          } else {
            document.getElementById("response").innerText = "Error al subir: " + data.status;
          }
        })
        .catch(error => {
          document.getElementById("response").innerText = "Error: " + error;
        });
      };

      document.getElementById("copyButton").onclick = function() {
        if (!lastLink) return;
        navigator.clipboard.writeText(lastLink)
          .then(() => alert("‚úÖ Link copiado al portapapeles"))
          .catch(() => alert("‚ùå Error al copiar el link"));
      };
    </script>
  </body>
</html>
